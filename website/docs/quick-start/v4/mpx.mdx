import Patch from './patch.mdx'
import CssImportReminder from '@site/src/components/CssImportReminder'

# Mpx

## å®‰è£…

```bash npm2yarn
npm install -D tailwindcss @tailwindcss/postcss postcss weapp-tailwindcss
```

<Patch />

## é…ç½®

æ›´æ”¹ `mpx.config.js` æ³¨å†Œ `weapp-tailwindcss`

```js title="mpx.config.js"
const { defineConfig } = require('@vue/cli-service')
const { UnifiedWebpackPluginV5 } = require('weapp-tailwindcss/webpack')
const path = require('node:path')
const tailwindPostcss = require('@tailwindcss/postcss')
module.exports = defineConfig({
  outputDir: `dist/${process.env.MPX_CURRENT_TARGET_MODE}`,
  pluginOptions: {
    mpx: {
      plugin: {
        postcssInlineConfig: {
          // tailwindcss@4 éœ€è¦åœ¨æ­¤å¤„æ³¨å†Œ @tailwindcss/postcssï¼Œè¯¦è§ templates/mpx-tailwindcss-v4/mpx.config.js
          ignoreConfigFile: true,
          plugins: [tailwindPostcss()]
        },
        srcMode: 'wx',
        hackResolveBuildDependencies: ({ files, resolveDependencies }) => {
          const path = require('path')
          const packageJSONPath = path.resolve('package.json')
          if (files.has(packageJSONPath)) files.delete(packageJSONPath)
          if (resolveDependencies.files.has(packageJSONPath)) {
            resolveDependencies.files.delete(packageJSONPath)
          }
        }
      },
      loader: {}
    }
  },
  configureWebpack(config) {
    // æ·»åŠ çš„ä»£ç åœ¨è¿™é‡Œ
    // highlight-start
    config.plugins.push(
      new UnifiedWebpackPluginV5({
        appType: 'mpx',
        rem2rpx: true,
        cssEntries: [
          // ä½  @import "tailwindcss"; é‚£ä¸ªæ–‡ä»¶ç»å¯¹è·¯å¾„
          path.resolve(__dirname, './src/app.css'),
        ],
      })
    )
    // highlight-end
  }
})
```

> tailwindcss@4 å¿…é¡»é…ç½® `cssEntries` å¹¶ä¸”ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå¦åˆ™ `tailwindcss` ç”Ÿæˆçš„ç±»åä¸ä¼šå‚ä¸è½¬è¯‘ã€‚
> tailwindcss@4 ä¸‹å¿…é¡»åœ¨ `mpx.config.js` é‡Œç”¨ `postcssInlineConfig` æ³¨å†Œ `@tailwindcss/postcss`ï¼ˆåŒä»“åº“ `templates/mpx-tailwindcss-v4/mpx.config.js` çš„å†™æ³•ï¼‰ï¼Œå¦åˆ™æ’ä»¶ä¸ä¼šç”Ÿæ•ˆï¼Œæ— éœ€å†å•ç‹¬ç»´æŠ¤ `postcss.config.js`ã€‚

## æ·»åŠ æ ·å¼

åœ¨ `src/app.css` ä¸­å¼•å…¥ `weapp-tailwindcss`ï¼š

```css title="src/app.css"
@import "tailwindcss";
```

<CssImportReminder />

> ğŸ’¡ å¦‚æœä½ å¸Œæœ›åœ¨ä»»æ„æ ·å¼æ–‡ä»¶ä¸­ç›´æ¥å¼•ç”¨åŒ…å†…æ ·å¼ï¼Œè¯·ä½¿ç”¨ `@import "weapp-tailwindcss/index.css";`ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ `postcss-import` è§£æåˆ°çš„æ˜¯çœŸå®çš„ CSS èµ„æºï¼Œé¿å…å‡ºç° "Unknown word "use strict"" è¿™ä¸€ç±»ç”±äºè¯¯è§£æåˆ° JS æ–‡ä»¶å¯¼è‡´çš„æ„å»ºæŠ¥é”™ã€‚

### Tailwind CSS æ ·å¼å¼•ç”¨æŒ‡å¼•

- **Tailwind CSS v3.x**ï¼šæ²¿ç”¨æ—§æ¨¡å—åå³å¯ï¼ˆä¾‹å¦‚ `@import 'tailwindcss/base.css'`ã€`@import 'tailwindcss/components.css'`ã€`@import 'tailwindcss/utilities.css'`ï¼‰ã€‚
- **Tailwind CSS v4.x**ï¼šæ¨èç›´æ¥å¼•å…¥ `weapp-tailwindcss` æä¾›çš„èšåˆæ ·å¼ï¼š

```html title="src/app.mpx"
<style lang="scss">
  @import 'weapp-tailwindcss/index.css';
</style>
```

è¿™æ ·å¯ä»¥ä¸€æ¬¡æ€§è·å¾— base / components / utilitiesï¼Œå¹¶è§„é¿ `postcss-import` è¯¯è§£æ JS å…¥å£çš„æŠ¥é”™ã€‚å¦‚æœä½ æ˜¯ä» v3 å‡çº§ï¼Œåªéœ€å°†åŸæ¥çš„ä¸‰ä¸ª `@import` æ¢æˆè¿™æ¡è¯­å¥å³å¯ã€‚

ç„¶ååœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼Œå°ç¨‹åºå…¨å±€çš„ `app.mpx` ä¸­ï¼Œé€šè¿‡ `@import` å¼•å…¥è¯¥æ–‡ä»¶ï¼š

```html title="app.mpx"
<style lang="css">
@import "./app.css";
</style>
```


æ›´æ”¹å¥½é…ç½®ä¹‹åï¼Œç›´æ¥å¯åŠ¨å³å¯


## å‚è€ƒæ¨¡ç‰ˆ

https://github.com/icebreaker-template/mpx-tailwindcss-v4
