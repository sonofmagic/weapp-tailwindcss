# 框架配置

<cite>
**本文档中引用的文件**  
- [taro.ts](file://packages/weapp-tailwindcss/src/presets/taro.ts)
- [uni-app.ts](file://packages/weapp-tailwindcss/src/presets/uni-app.ts)
- [uni-app-x.ts](file://packages/weapp-tailwindcss/src/presets/uni-app-x.ts)
- [shared.ts](file://packages/weapp-tailwindcss/src/presets/shared.ts)
- [index.ts](file://packages/weapp-tailwindcss/src/types/index.ts)
- [vite.config.ts](file://apps/uni-app-x-hbuilderx-tailwindcss4/vite.config.ts)
- [app.config.ts](file://apps/rsmax-app-ts/src/app.config.ts)
- [project.config.json](file://apps/vite-native/project.config.json)
- [pages.json](file://apps/uni-app-x-hbuilderx-tailwindcss4/pages.json)
- [tailwind.config.js](file://apps/taro-webpack-tailwindcss-v4/tailwind.config.js)
</cite>

## 目录
1. [简介](#简介)
2. [支持的框架类型](#支持的框架类型)
3. [框架检测机制](#框架检测机制)
4. [各框架配置详解](#各框架配置详解)
   - [Taro 框架配置](#taro-框架配置)
   - [uni-app 框架配置](#uni-app-框架配置)
   - [uni-app x 框架配置](#uni-app-x-框架配置)
   - [原生小程序配置](#原生小程序配置)
5. [配置陷阱与最佳实践](#配置陷阱与最佳实践)
6. [总结](#总结)

## 简介
本文档详细说明了 `weapp-tailwindcss` 工具对不同小程序开发框架的支持情况，涵盖 Taro、uni-app、Rax、原生小程序等主流框架的配置方式。文档将解释框架检测机制、手动指定框架的方法，并提供各框架下的完整配置示例和注意事项。

**Section sources**
- [index.ts](file://packages/weapp-tailwindcss/src/types/index.ts#L22-L23)

## 支持的框架类型
根据源码分析，系统支持以下开发框架：

- **uni-app**：基于 Vue 的跨平台开发框架
- **uni-app-vite**：使用 Vite 构建的 uni-app 项目
- **taro**：京东出品的多端统一开发框架
- **remax**：基于 React 的小程序开发框架
- **rax**：阿里巴巴的跨端解决方案
- **native**：原生小程序开发模式
- **kbone**：微信官方的同构解决方案
- **mpx**：增强型小程序开发框架
- **weapp-vite**：使用 Vite 构建的原生小程序

这些框架类型定义在类型文件中，用于指导插件的行为和配置。

**Section sources**
- [index.ts](file://packages/weapp-tailwindcss/src/types/index.ts#L22)

## 框架检测机制
系统通过多种方式自动检测项目所使用的开发框架：

1. **环境变量检测**：对于 uni-app 项目，通过 `UNI_PLATFORM` 环境变量判断当前编译平台
2. **配置文件识别**：通过项目中的特定配置文件（如 `project.config.json`、`app.config.ts` 等）识别框架类型
3. **依赖包分析**：检查 `package.json` 中的依赖项来确定使用的框架
4. **目录结构判断**：根据项目目录结构特征进行框架识别

当自动检测无法确定框架时，开发者可以手动指定 `appType` 参数。

**Section sources**
- [uni-app.ts](file://packages/weapp-tailwindcss/src/presets/uni-app.ts#L8-L9)

## 各框架配置详解

### Taro 框架配置
Taro 框架使用 `taro` 作为 `appType` 值。配置主要通过 `app.config.ts` 文件进行。

```typescript
// apps/rsmax-app-ts/src/app.config.ts
export default {
  pages: [
    'pages/index/index'
  ],
  window: {
    backgroundTextStyle: 'light',
    navigationBarBackgroundColor: '#fff',
    navigationBarTitleText: 'WeChat',
    navigationBarTextStyle: 'black'
  }
}
```

在构建配置中集成 Tailwind CSS：

```typescript
// vite.config.ts 或 webpack 配置
import { taro } from 'weapp-tailwindcss/presets'

export default {
  plugins: [
    // 其他插件...
    taro()
  ]
}
```

**Section sources**
- [taro.ts](file://packages/weapp-tailwindcss/src/presets/taro.ts)
- [app.config.ts](file://apps/rsmax-app-ts/src/app.config.ts)

### uni-app 框架配置
uni-app 框架使用 `uni-app` 作为 `appType` 值。配置通过 `pages.json` 文件进行管理。

```json
// pages.json
{
  "pages": [
    {
      "path": "pages/index/index",
      "style": {
        "navigationBarTitleText": "首页"
      }
    }
  ],
  "globalStyle": {
    "navigationBarTextStyle": "black",
    "navigationBarBackgroundColor": "#ffffff",
    "backgroundColor": "#f8f8f8"
  }
}
```

在构建配置中：

```typescript
// vite.config.ts
import { uniApp } from 'weapp-tailwindcss/presets'

export default defineConfig({
  plugins: [
    uniApp()
  ]
})
```

注意：当 `UNI_PLATFORM` 为 `h5` 或 `app` 时，插件会自动禁用，避免在非小程序平台应用小程序特定的转换。

**Section sources**
- [uni-app.ts](file://packages/weapp-tailwindcss/src/presets/uni-app.ts)
- [pages.json](file://apps/uni-app-x-hbuilderx-tailwindcss4/pages.json)

### uni-app x 框架配置
uni-app x 是 uni-app 的下一代版本，使用 `uni-app-x` 预设。配置方式与 uni-app 类似，但针对新的编译器进行了优化。

```typescript
// vite.config.ts
import { uniAppX } from 'weapp-tailwindcss/presets'

export default defineConfig({
  plugins: [
    uniAppX()
  ]
})
```

**Section sources**
- [uni-app-x.ts](file://packages/weapp-tailwindcss/src/presets/uni-app-x.ts)

### 原生小程序配置
原生小程序开发使用 `native` 作为 `appType` 值。配置通过 `project.config.json` 文件进行。

```json
// project.config.json
{
  "description": "项目配置文件",
  "packOptions": {
    "ignore": []
  },
  "setting": {
    "urlCheck": false,
    "es6": true,
    "enhance": false,
    "postcss": false,
    "minified": false,
    "newFeature": false
  },
  "compileType": "miniprogram",
  "libVersion": "3.4.4",
  "appid": "your-appid",
  "projectname": "my-project",
  "debugOptions": {
    "hidedInDevtools": []
  },
  "isGameTourist": false,
  "simulatorType": "wechat",
  "simulatorPluginLibVersion": {},
  "condition": {}
}
```

在构建工具配置中：

```typescript
// vite.config.ts
import weappTailwindcss from 'weapp-tailwindcss/vite'

export default defineConfig({
  plugins: [
    weappTailwindcss({
      appType: 'native'
    })
  ]
})
```

**Section sources**
- [project.config.json](file://apps/vite-native/project.config.json)

## 配置陷阱与最佳实践

### 常见配置陷阱
1. **环境变量冲突**：在 uni-app 项目中，确保 `UNI_PLATFORM` 环境变量正确设置
2. **配置顺序问题**：确保 weapp-tailwindcss 插件在其他 CSS 处理插件之前执行
3. **路径解析错误**：在跨文件分析时，确保模块解析函数正确配置
4. **缓存问题**：在开发过程中，注意清除缓存以避免旧的样式类名残留

### 最佳实践
1. **明确指定框架类型**：即使框架可以自动检测，也建议显式指定 `appType`
2. **合理配置缓存**：在生产环境中启用缓存以提高构建性能
3. **分环境配置**：为开发和生产环境使用不同的配置选项
4. **渐进式集成**：对于大型项目，建议逐步集成 Tailwind CSS，先从部分页面开始

```typescript
// 推荐的配置模式
const config = {
  appType: 'taro', // 明确指定框架类型
  cache: true, // 启用缓存
  disabled: process.env.NODE_ENV === 'development' ? false : undefined,
  // 其他配置...
}
```

**Section sources**
- [shared.ts](file://packages/weapp-tailwindcss/src/presets/shared.ts)

## 总结
本文档详细介绍了 `weapp-tailwindcss` 对各种小程序开发框架的支持情况。通过理解不同框架的配置方式和注意事项，开发者可以更有效地集成 Tailwind CSS 到自己的项目中。建议在实际使用中参考对应框架的示例项目进行配置。