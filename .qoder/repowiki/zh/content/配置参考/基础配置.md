# 基础配置

<cite>
**本文档中引用的文件**  
- [types.ts](file://packages/weapp-tailwindcss/src/types.ts)
- [defaults.ts](file://packages/weapp-tailwindcss/src/defaults.ts)
- [core.ts](file://packages/weapp-tailwindcss/src/core.ts)
- [vite.ts](file://packages/weapp-tailwindcss/src/vite.ts)
- [webpack.ts](file://packages/weapp-tailwindcss/src/webpack.ts)
- [cli.ts](file://packages/weapp-tailwindcss/src/cli.ts)
</cite>

## 目录
1. [简介](#简介)
2. [核心配置项详解](#核心配置项详解)
3. [配置文件查找机制与优先级](#配置文件查找机制与优先级)
4. [实际项目结构中的配置示例](#实际项目结构中的配置示例)
5. [常见配置错误及解决方案](#常见配置错误及解决方案)
6. [总结](#总结)

## 简介
`weapp-tailwindcss` 是一个专为小程序环境设计的 Tailwind CSS 集成工具，支持多种小程序框架（如微信小程序、Taro、UniApp 等）。本文档聚焦于其基础配置项，包括 `root`、`project`、`mode`、`css`、`configPath` 等，详细解释每个配置项的类型定义、默认值、作用域和使用场景，并确保与 `src/types.ts` 中的类型定义完全一致。

## 核心配置项详解

### root
- **类型定义**: `string`
- **默认值**: `process.cwd()`
- **作用域**: 全局
- **使用场景**: 指定项目的根目录路径。该路径用于解析相对路径配置和查找配置文件。
- **说明**: `root` 配置项决定了插件在运行时的上下文目录，所有相对路径都将基于此目录进行解析。

**Section sources**
- [core.ts](file://packages/weapp-tailwindcss/src/core.ts#L13-L76)

### project
- **类型定义**: `string`
- **默认值**: `undefined`
- **作用域**: 构建上下文
- **使用场景**: 指定小程序项目的 `project.config.json` 文件路径。
- **说明**: 当使用 Vite 或 Webpack 构建时，`project` 配置项用于读取小程序项目的配置信息，如项目路径、编译选项等。

**Section sources**
- [vite.ts](file://packages/weapp-tailwindcss/src/vite.ts#L1-L50)
- [webpack.ts](file://packages/weapp-tailwindcss/src/webpack.ts#L1-L50)

### mode
- **类型定义**: `'development' | 'production'`
- **默认值**: `'development'`
- **作用域**: 构建环境
- **使用场景**: 控制构建过程中的行为，例如是否启用压缩、是否生成 sourcemap 等。
- **说明**: `mode` 配置项影响插件在不同环境下的行为，例如在生产环境中会自动启用 CSS 压缩和类名混淆。

**Section sources**
- [defaults.ts](file://packages/weapp-tailwindcss/src/defaults.ts#L44-L138)

### css
- **类型定义**: `string | boolean`
- **默认值**: `true`
- **作用域**: 样式处理
- **使用场景**: 指定需要处理的 CSS 文件路径或模式。
- **说明**: `css` 配置项可以是一个布尔值或字符串，用于控制哪些 CSS 文件需要被 `weapp-tailwindcss` 处理。当设置为 `true` 时，所有匹配默认模式的 CSS 文件都会被处理。

**Section sources**
- [defaults.ts](file://packages/weapp-tailwindcss/src/defaults.ts#L55-L56)

### configPath
- **类型定义**: `string`
- **默认值**: `undefined`
- **作用域**: 配置加载
- **使用场景**: 指定自定义配置文件的路径。
- **说明**: `configPath` 允许用户指定一个自定义的配置文件路径，以便覆盖默认配置。该路径可以是绝对路径或相对于 `root` 的相对路径。

**Section sources**
- [cli.ts](file://packages/weapp-tailwindcss/src/cli.ts#L1-L20)

## 配置文件查找机制与优先级

`weapp-tailwindcss` 在启动时会按照一定的顺序查找配置文件，优先级如下：
1. 命令行参数中指定的 `configPath`
2. 项目根目录下的 `weapp-tailwindcss.config.js` 或 `weapp-tailwindcss.config.ts`
3. 默认配置（由 `getDefaultOptions` 提供）

如果多个配置源同时存在，优先级高的配置会覆盖优先级低的配置。

**Section sources**
- [core.ts](file://packages/weapp-tailwindcss/src/core.ts#L13-L76)
- [defaults.ts](file://packages/weapp-tailwindcss/src/defaults.ts#L44-L138)

## 实际项目结构中的配置示例

以下是一个典型的 `weapp-tailwindcss.config.js` 配置文件示例：

```js
module.exports = {
  root: __dirname,
  project: './project.config.json',
  mode: process.env.NODE_ENV === 'production' ? 'production' : 'development',
  css: true,
  configPath: './custom-config.js',
};
```

此配置文件展示了如何在实际项目中设置 `root`、`project`、`mode`、`css` 和 `configPath` 等基础配置项。

**Section sources**
- [defaults.ts](file://packages/weapp-tailwindcss/src/defaults.ts#L44-L138)

## 常见配置错误及解决方案

### 路径配置错误
- **问题**: `root` 或 `project` 路径配置错误导致无法找到项目文件。
- **解决方案**: 确保路径是正确的绝对路径或相对于 `root` 的相对路径，并检查文件是否存在。

### 模式设置不当
- **问题**: `mode` 设置为 `development` 但在生产环境中未启用压缩。
- **解决方案**: 根据环境变量正确设置 `mode`，确保生产环境中启用压缩和优化。

**Section sources**
- [defaults.ts](file://packages/weapp-tailwindcss/src/defaults.ts#L44-L138)
- [core.ts](file://packages/weapp-tailwindcss/src/core.ts#L13-L76)

## 总结
本文档详细介绍了 `weapp-tailwindcss` 的基础配置项，包括 `root`、`project`、`mode`、`css` 和 `configPath` 的类型定义、默认值、作用域和使用场景。通过理解这些配置项及其查找机制，开发者可以更有效地集成和使用 `weapp-tailwindcss`，避免常见的配置错误。

**Section sources**
- [types.ts](file://packages/weapp-tailwindcss/src/types.ts)
- [defaults.ts](file://packages/weapp-tailwindcss/src/defaults.ts#L44-L138)