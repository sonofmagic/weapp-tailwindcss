# Packages Code Review

## Key Findings

1. Both `packages/weapp-tailwindcss/src/bundlers/webpack/BaseUnifiedPlugin/v5.ts:154` and `packages/weapp-tailwindcss/src/bundlers/webpack/BaseUnifiedPlugin/v4.ts:150` build the cache key for JS/WXS assets with `removeExt(file)`. As soon as a project ships `foo.js` alongside `foo.wxs`, caching makes them collide: whichever file is processed first seeds the cache and the other reuses that output. The strip-extension behaviour was intended for `.map` handling but breaks mixed extensions; keep the full filename (or suffix the key with the current extension) and only drop `.map` when operating on source maps.
2. `packages/tailwindcss-injector/src/postcss.ts:122` always overwrites the Tailwind `content` option with a plain array. Callers supplying the object form—e.g. `{ content: { files, extract } }` to retain custom extractors—lose those extract/transform hooks and Tailwind stops matching JSX/Markdown. Detect the shape the user provided and merge intelligently, updating only `files`/`content.files` so the rest of the configuration survives.

## Recommended Actions

- Fix the webpack plugin cache-key construction and add a regression test that covers JS + WXS pairs with caching enabled.
- Rework the tailwindcss-injector content merge strategy and back it with a fixture that keeps custom extractors intact.
